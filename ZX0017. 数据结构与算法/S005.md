# 17.5 红黑树（1）- 基本概念

更新日期：2020/06/26

---------------------------------------

## 1. 概述

据说，红黑树是最复杂的一种数据结构。从标题就可以看出来，需要分成多个章节来学习和介绍。

想要用一句话简洁的说明白红黑树确实是很困难的。下面我就分成几个小节来说明。

## 2. 定义

直接列出维基百科上关于红黑树的定义。话说居然有5个条件之多，要定义出一棵符合这样的条件的树也绝非易事。

- (1) 节点是红色或黑色。
- (2) 根是黑色。
- (3) 所有叶子都是黑色（叶子是NIL节点）。
- (4) 每个红色节点必须有两个黑色的子节点。（从每个叶子到根的所有路径上不能有两个连续的红色节点。）
- (5) 从任一节点到其每个叶子的所有简单路径都包含相同数目的黑色节点。

符合这样条件的红黑树大概长什么样子呢？先来张图感受一下。

{% dot attack_plan.svg
digraph G { 

    node [shape=circle, width=0.5, fixedsize=true]
    nodesep=0.3
    edge[arrowhead=vee]

    // 如果是红黑树，则设置所有节点为红色
    node [style=filled, fillcolor="#AA0000", fontcolor=white]

    // 定义图的节点，"n"开头的为占位节点
    // lv1
    54
    // lv2
    33 n54 556
    // lv3
    3 n33 45
    67 n556 2423
    // lv4
    1 n3 4
    55 n67 99
    2345 n2423 6666
    // lv5
    98 n99 100

    // 设置父子关系
    // lv1 -> lv2
    54 -> 33, 556
    // lv2 -> lv3
    33 -> 3, 45
    556 -> 67, 2423
    // lv3 -> lv4
    3 -> 1, 4
    67 -> 55, 99
    2423 -> 2345, 6666
    // lv4 -> lv5
    99 -> 98, 100

    // 连接父节点与占位节点，并将连接线设置为隐藏
    54 -> n54 [style=invis]
    33 -> n33 [style=invis]
    556 -> n556 [style=invis]
    3 -> n3 [style=invis]
    67 -> n67 [style=invis]
    2423 -> n2423 [style=invis]
    99 -> n99 [style=invis]

    // 占位节点设置为隐藏
    n54, n33, n556, n3, n67, n2423, n99 [width=0, height=0, style=invis]

    // 将父节点与占位节点设置为同一个组，使其在竖直方向上对齐
    54, n54 [group=n54]
    33, n33 [group=n33]
    556, n556 [group=n556]
    3, n3 [group=n3]
    67, n67 [group=n67]
    2423, n2423 [group=n2423]
    99, n99 [group=n99]

    // 如果是红黑树，则设置黑色节点的颜色
    54, 33, 556, 3, 45, 2423, 55, 99 [style=filled, fillcolor=black, fontcolor=white]
} 
%}

## 3. 为什么需要红黑树

红黑树起源于排序二叉树。也就是`左子节点 <= 父节点 <= 右子节点`的那种二叉树。

排序二叉树的特点就是查找元素比较快，比较较少的次数就可以查找到目标元素。有点像排序数组的二分查找。

但是排序二叉树有其弱点。比如我连续插入20个随机数来创建一棵树。

![排序二叉树](S005.files/排序二叉树.PNG)

有没有发现这棵二叉树有点丑，它的元素分布极不均匀。查找有的元素需要比较很多的次数，查找效率极不均匀。最坏的情况下甚至需要比较所有的元素才能找到目标元素。

再看看同样的这20个数字创建出来的红黑树。

![排序二叉树](S005.files/红黑树.PNG)

可以看到，这棵树非常的均匀。查找任何元素都不会需要很多的比较次数，最坏的情况也没有很坏。

## 4. 需要学习的主题

目前为止只是大概了解了一下红黑树的概念。红黑树的算法实现比较复杂，我将分为三个章节来学习。

- 红黑树的基本原理
- 红黑树的插入
- 红黑树的删除