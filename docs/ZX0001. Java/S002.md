# B. 读取Excel文档

更新日期：2020-07-23

-------------------------------------

## 1. 概述

这里仅讨论Excel文档的读取，而不考虑写入和保存。常用的一种使用场景是：

- 在Office Excel工具中填写数据并保存
- 在程序中读取Excel文件来进行一些自动化处理

## 2. 准备工作

可以使用org.apache.poi库来读取xlsx文件。

在Maven中搜如下两个poi库然后添加到pom.xml文件中:(以使用Maven为例)

- poi
- poi-ooxml

两个都是必须的。这两个Jar包里类的目录都是org.apache.poi开头的，经常会忘记引用poi-ooxml这个包。

## 2. 读取XLSX文件

### 2.1 加载文件

```java
FileInputStream fs = new FileInputStream(xlsx文件路径);
XSSFWorkbook wb = new XSSFWorkbook(fs);
```

### 2.2 取得指定sheet

根据index取，也就是xlsx文件中的第几个sheet页：

```java
XSSFSheet sheet = wb.getSheetAt(sheetIndex);
```

也可以根据sheet名字来取：

```java
XSSFSheet sheet = wb.getSheet(sheetName);
```

### 2.3 取得sheet中指定的元素

```java
XSSFCell cell = sheet.getRow(row).getCell(col);
```

这是取指定行列位置的元素。这只是最基本的用法，还有更多复杂的用法只要查看类的成员函数便知。
